---
title: 存储系统
weight: 3
---
### 存储器的层次结构
寄存器 Cache(高速缓冲存储器) 主存(内存) 磁盘(辅存) 磁带、光盘。
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121558197.png)
主存-辅存：实现了虚拟存储系统，结果主存容量不够的问题。辅存与主存内容交换一般是由硬件和操作系统完成，涉及到操作系统中的页面置换算法。
Cache-主存：解决了主存与CPU速度不匹配的问题。是由硬件自动完成的。
辅存的数据必须调入主存后才能被CPU访问。
频繁被访问的数据可以复制一份到Cache中，更方便CPU读取。
CPU进行一些加减运算时，操作数就存在寄存器，寄存器访问更快，但是其价格贵，数量更少。
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121558271.png)

### 存储器的分类
#### 按层次分类
高速缓存
主存储器
辅助存储器
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121607679.png)
#### 按存储介质分类
半导体存储器：主存、Cache
磁表面存储器：磁盘、磁带
光存储器：光盘
#### 按存取方式分类
- 随机存取存储器（Random Acess Memory）：
读写任何一个存储单元所需时间都一样，与物理位置无关。
- 顺序存取存储器（Sequential Acess Memory）：
读写每一个存储单元所需的时间取决于存储单元所在的物理位置。
- 直接存取存储器（Direct Acess Memory）：
既有随机读取的特性，又有顺序读取的特性，先随机选取目标数据扇区，再顺序方式读取数据。
顺序存取和直接读取都是串行访问存储器，读写某个存储单元所需时间与存储器单元的物理位置有关。
- 相联存储器（Associative Memory）：
即可以按内容访问的存储器，也可以按照内容检索到存储位置进行读写，“快表”就是一种。
#### 按信息的更改性分类
读写存取器：可读可写（磁盘，内存，Cache等）
只读存储器（Read Only Memory）：只能读，不能写。（BIOS写到ROM上，实体音乐专辑存储到CD-ROM上）
#### 按信息的可保存性分类
易失性存储器：断电后存储信息消失，（Cache、主存）
非易失性存储器：断电后存储信息依旧保存，（磁盘、光盘）
破坏性读出：信息读出后，原存储信息被破坏。（DRAM芯片，读出数据后要进行重写）
非破坏性读出：信息读出后，原存储信息不被破坏。（SRAM、磁盘、光盘）
### 存储器的性能指标
存储容量：存储字数 \* 字长（如1M\*8位)
MDR位数反映存储字长，MAR位数反映存储字数。
单位成本：每位(bit)价格 = 总成本 / 总容量
存储速度：数据传输率=数据的宽度/存储周期。
数据宽度位存储字长。
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121635855.png)

存储周期包括存取时间和恢复时间。
存取时间是从一次启动存储器操作到完成该操作所经历的时间，分为读出时间和写入时间。
存储周期也被称为读写周期或访问周期。指存储器进行一次完整的读写操作所需的全部时间，即连续两次独立地访问存储器操作之间所需的最小时间间隔。

主存带宽又称为数据传输率。表示每秒从主存进出信息的最大数量。单位为字、字节Byte、位bit 每秒。
## 主存储器的基本组成
### 基本半导体元件
MOS管：施加的电压达到某个阈值，MOS管就可以连通。
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121641169.png)
MOS管接通后，电容与外部导线连接。
电容如果存储的电荷在放电后电荷流出，外部导线监测到高电平即信号1，若电容不存储电荷，则外部导线监测到低电平即信号0。
### 存储芯片的结构
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121645513.png)
存储字长与每个存储体设计有关。
与CPU相连的地址总线连通MAR，然后通过译码器连接存储的单元的字选线来选择。字选线
与CPU与相连的数据总线宽度未存储字长，即图中绿线。位选线。
存储体总容量为 存储单元个数 \* 存储字长。
控制电路
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121655339.png)

片选线：一个内存条可能包含多个存储芯片，用片选线来判断选择的存储芯片编号。
读写控制线：可能为两根，一根控制写，一根控制读，或只用一根。向外暴露的引脚个数。
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121656037.png)
上图中每个线都会对应一个金属引脚。
n位地址 对应 2<sup>n</sup>的存储单元。
8K \* 8位 即2<sup>13</sup> \* 8bit容量，地址线有13位，数据线有8位。
###  寻址
现代计算机通常按字节编址，即每个字节对应一个地址。
对于总容量为1KB的存储体。地址线为10条，数据线为8条
- 按字节寻址，1K个单元，每个单元存储1B的二进制数据。
- 按字寻址，将四个连续的字节合并为一个字，一次读取一个字，即256个单元，每个单元4B，字节地址算数左移两位转换为按字寻址的地址。
- 按半字寻址，将连续的两个字节合并为一个字。总共512个单元，每个单元存储2B的二进制数据。
- 按双字寻址，将连续的八个字节合并为一个字。总共128个单元，每个单元存储8B的二进制数据。
## SRAM与DRAM
静态RAM与动态RAM
DRAM用于主存，SRAM用于Cache
### 存储元件不同而导致的特性差异
##### 栅极电容
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121734757.png)
电容放电后，信息会被破坏，是破坏性读出，读出后应该对数据重写。
每个存储元制造成本低，集成度高，功耗低。
电容中的电荷信息即使不读取也会丢失，一般只能维持2ms，所以需要频繁对电容进行刷新。
##### 双稳态触发器
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121735704.png)
有两种稳定的状态：
1：A高电平，B低电平。
0：A低电平，B高电平。
读出数据后，触发器状态依旧稳定，读数据为非破坏性读出，无需重写。
每个存储元制造成本高，器件多，集成度低，功耗高。
##### 两种器件的特性对比：
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121740416.png)
两种断电之后信息都会消失，都是易失性读出。
### DRAM的刷新
多久需要刷新一次？
刷新周期一般为2ms，
每次刷新多少存储单元？
以行为单位，每次刷新一行存储单元。简单模型为存储单元按号排序，20位地址线就排0到2<sup>20</sup> - 1号存储单元，译码器出线非常多。
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121758329.png)
如果用行列地址来定址，那么只需要一个行地址译码器和一个列地址译码器，每个译码器只需要确定0到1023号，相比来说减少了很多。 
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121759394.png)

### DRAM的地址线复用技术
### 单块存储芯片与CPU的链接
#### 字扩展
扩展主存字数
#### 位扩展
数据总线宽度大于存储芯片
