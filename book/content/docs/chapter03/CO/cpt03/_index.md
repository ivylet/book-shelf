---
title: 第三章|存储系统
weight: 3
---
# 存储器概述
## 存储器的层次结构
寄存器 Cache(高速缓冲存储器) 主存(内存) 磁盘(辅存) 磁带、光盘。  

![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121558197.png)


主存-辅存：实现了虚拟存储系统，结果主存容量不够的问题。辅存与主存内容交换一般是由硬件和操作系统完成，涉及到操作系统中的页面置换算法。   
Cache-主存：解决了主存与CPU速度不匹配的问题。是由硬件自动完成的。   
辅存的数据必须调入主存后才能被CPU访问。   
频繁被访问的数据可以复制一份到Cache中，更方便CPU读取。   
CPU进行一些加减运算时，操作数就存在寄存器，寄存器访问更快，但是其价格贵，数量更少。    
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121558271.png)

## 存储器的分类
#### 按层次分类
高速缓存  
主存储器  
辅助存储器  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121607679.png)
#### 按存储介质分类
半导体存储器：主存、Cache   
磁表面存储器：磁盘、磁带   
光存储器：光盘   
#### 按存取方式分类
- 随机存取存储器（Random Acess Memory）：
读写任何一个存储单元所需时间都一样，与物理位置无关。   
- 顺序存取存储器（Sequential Acess Memory）：
读写每一个存储单元所需的时间取决于存储单元所在的物理位置。   
- 直接存取存储器（Direct Acess Memory）：
既有随机读取的特性，又有顺序读取的特性，先随机选取目标数据扇区，再顺序方式读取数据。   
顺序存取和直接读取都是串行访问存储器，读写某个存储单元所需时间与存储器单元的物理位置有关。   
- 相联存储器（Associative Memory）：
即可以按内容访问的存储器，也可以按照内容检索到存储位置进行读写，“快表”就是一种。  
#### 按信息的更改性分类
读写存取器：可读可写（磁盘，内存，Cache等）    
只读存储器（Read Only Memory）：只能读，不能写。（BIOS写到ROM上，实体音乐专辑存储到CD-ROM上）   
#### 按信息的可保存性分类
易失性存储器：断电后存储信息消失，（Cache、主存）    
非易失性存储器：断电后存储信息依旧保存，（磁盘、光盘）    
破坏性读出：信息读出后，原存储信息被破坏。（DRAM芯片，读出数据后要进行重写）    
非破坏性读出：信息读出后，原存储信息不被破坏。（SRAM、磁盘、光盘）    
### 存储器的性能指标
存储容量：存储字数 \* 字长（如1M\*8位)    
MDR位数反映存储字长，MAR位数反映存储字数。   
单位成本：每位(bit)价格 = 总成本 / 总容量   
存储速度：数据传输率=数据的宽度/存储周期。      
数据宽度位存储字长。   

![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121635855.png)

存储周期包括存取时间和恢复时间。  
存取时间是从一次启动存储器操作到完成该操作所经历的时间，分为读出时间和写入时间。  
存储周期也被称为读写周期或访问周期。指存储器进行一次完整的读写操作所需的全部时间，即连续两次独立地访问存储器操作之间所需的最小时间间隔。   

主存带宽又称为数据传输率。表示每秒从主存进出信息的最大数量。单位为字、字节Byte、位bit 每秒。  
# 主存储器
## 主存储器的基本组成
### 基本半导体元件
MOS管：施加的电压达到某个阈值，MOS管就可以连通。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121641169.png)
MOS管接通后，电容与外部导线连接。  
电容如果存储的电荷在放电后电荷流出，外部导线监测到高电平即信号1，若电容不存储电荷，则外部导线监测到低电平即信号0。  
### 存储芯片的结构
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121645513.png)
存储字长与每个存储体设计有关。  
与CPU相连的地址总线连通MAR，然后通过译码器连接存储的单元的字选线来选择。字选线    
与CPU与相连的数据总线宽度未存储字长，即图中绿线。位选线。    
存储体总容量为 存储单元个数 \* 存储字长。    
控制电路    
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121655339.png)
  
片选线：一个内存条可能包含多个存储芯片，用片选线来判断选择的存储芯片编号。   
读写控制线：可能为两根，一根控制写，一根控制读，或只用一根。向外暴露的引脚个数。      
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121656037.png)
上图中每个线都会对应一个金属引脚。     
n位地址 对应 2<sup>n</sup>的存储单元。    
8K \* 8位 即2<sup>13</sup> \* 8bit容量，地址线有13位，数据线有8位。    
###  寻址
现代计算机通常按字节编址，即每个字节对应一个地址。   
对于总容量为1KB的存储体。地址线为10条，数据线为8条    
- 按字节寻址，1K个单元，每个单元存储1B的二进制数据。  
- 按字寻址，将四个连续的字节合并为一个字，一次读取一个字，即256个单元，每个单元4B，字节地址算数左移两位转换为按字寻址的地址。
- 按半字寻址，将连续的两个字节合并为一个字。总共512个单元，每个单元存储2B的二进制数据。
- 按双字寻址，将连续的八个字节合并为一个字。总共128个单元，每个单元存储8B的二进制数据。
## SRAM与DRAM
静态RAM与动态RAM    
DRAM一般用于主存，SRAM一般用于Cache  
### 存储元件不同而导致的特性差异
##### 栅极电容
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121734757.png)
电容放电后，信息会被破坏，是破坏性读出，读出后应该对数据重写。
每个存储元制造成本低，集成度高，功耗低。  
电容中的电荷信息即使不读取也会丢失，一般只能维持2ms，所以需要频繁对电容进行刷新。  
##### 双稳态触发器
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121735704.png)
有两种稳定的状态：
1：A高电平，B低电平。  
0：A低电平，B高电平。  
读出数据后，触发器状态依旧稳定，读数据为非破坏性读出，无需重写。  
每个存储元制造成本高，器件多，集成度低，功耗高。  
##### 两种器件的特性对比：
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121740416.png)
两种断电之后信息都会消失，都是易失性读出。  
### DRAM的刷新
#### 多久需要刷新一次？  
刷新周期一般为2ms，  
#### 每次刷新多少存储单元？  
以行为单位，每次刷新一行存储单元。   
简单模型为存储单元按号排序，如果采用20位地址线就，那么就要排0到2<sup>20</sup> - 1号存储单元，也就是需要出2<sup>20</sup>条线，显然很难实现。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121758329.png)
  
如果用行列地址来定址，那么只需要一个行地址译码器和一个列地址译码器，每个译码器只需要确定0到1023号，相比来说减少了很多。地址分为行地址和列地址，前半部分为行地址，后半部分为列地址。减少了连通线的数量。     
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121759394.png)  
#### 如何刷新？
有相关硬件支持，由存储器独立完成，不需要CPU控制。每次读取一行存储单元的信息后，重新写入，占用1个读/写周期。  
#### 在什么时候刷新呢？
假设DRAM内部结构排列成128x128的形式，读写周期为0.5us，2ms共2ms/0.5us = 4000个周期。
1. 分散刷新
每次读写玩都刷新一行，系统的存储周期会变长，前0.5us时间用于正常读写，后0.5us时间用于刷新，系统存储周期变为1us。  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121948120.png)

2. 集中刷新
选择2ms集中安排时间全部刷新，系统的存储周期不变，但有一段时间专门用于刷新，此时无法访问存储器，称之为“死区”  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121950650.png)

3. 异步刷新
2ms内每行刷新一次即可-> 2ms内需要产生128次刷新请求即，每隔2ms/128 = 15.6us一次，而每15.6us就有0.5us的死时间，相比集中刷新，异步刷新更分散。    
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306121953167.png)
### DRAM的地址线复用技术
由上边可知，DRAM如果存储单元过多，会导致译码器所需连接线过多，所以采用了行列地址来定址，每次刷新都是可以直接刷新一行，根据这个特性，可以在送行列地址时，将地址分为两次发送，一次为行，一次为列，通过相同的引脚输入。这样可以使地址线数减半，芯片引脚中地址引脚数减半。    

###### 关于外接引脚个数
SRAM 的外部引脚线是片选线和读写控制线，以及地址线和数据线。DRAM的外部引脚线是行选通信号线和列选通信号和线，读写控制线，以及地址线和数据线。  

现在主流主存储器采用SDRAM，DRAM被淘汰了。  
## 只读存储器ROM
### 常见ROM
ROM芯片是非易失性的，即断电后数据不会丢失。  
一般有MROM、PROM、EPROM、闪存、SSD等。
- MROM掩模式只读存储器，
一次写入后，之后任何人不可以重写。可靠性高，集成度高，价格便宜；缺点是灵活性差。
- PROM可编程只读存储器，
用户可以用专门的PROM写入器写入信息，写入一次后就不能更改。 
- EPROM可擦除可编程只读存储器
用户可以通过编程器写入信息，也可以进行多次修改，虽然即可读又可以写，但是编程次数有限，不能替代RAM。   
LIVEPROM 用紫外写照射8-20分钟，可以擦除所有信息。    
EEPROM 可以用电擦除的方式，擦除特定的字。   
- Flash Memory 闪存
由EEPROM发展而来，可用长期保存信息，也可以在线进行快速擦除与重写，既有价格便宜集成度高的特点，断电后可以保存信息，并且可以进行多次快速擦除重写。闪存需要先擦除再写入，因此闪存的“写”速度要比“读”慢。每个存储单元 只需要单个MOS管，位密度比RAM高。
- Soil State Drivers 固态硬盘
由控制单元加存储单元（Flash芯片）构成，与Flash核心区别在于控制单元不同，可以进行多次快速擦除重写，速度快，功耗低，价格高。 
### 计算机内重要的ROM
电脑关机后，RAM不通电，其内部的数据全部丢失，计算机下次开机时需要启动代码，这部分代码存在主板上的一块ROM中（BIOS），逻辑上一般将这一块与主存放到一起。编址时，一般将这块ROM上的内容编写到地址首位。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122026529.png)

## 双端口RAM和多模块存储器
主存的优化技术。
##### 存取周期
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122036703.png)
如果有多核CPU都要访存，怎么办？CPU读写速度比主存快很多，主存恢复时间太长怎么办？   
### 双端口RAM（大纲已删）
主要作用: 优化多核CPU访问同一根内存条的速度。    
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122041578.png)   

主存需要有完全两组独立的数据线、地址线、控制线。CPU、RAM中也要有更复杂的控制电路。  
两个端口对同一主存进行操作有4中情况：
1. 两个端口同时对不同的地址单元存取数据。 允许
2. 两个端口同时对同一的地址单元读出数据。 允许
3. 两个端口同时对同一的地址单元写入数据。 写入错误
4. 两个端口同时对同一的地址单元，一个读入数据，一个写入数据。 读出错误
如果出现3 4的情况，置忙信号，由判断逻辑暂时关闭一个端口（延时接入），另一个端口正常访问。  
### 多模块存储器
利用多个结构相同的存储模块的并行工作来提高存储器的吞吐率。  
CPU的速度比存储器快，若同时从存储器中取出n条指令，就可以充分利用CPU资源，提高运行速度。多体交叉存储器就是基于这种思想实现的。  
存储体中存的多数数据是连续存储的，比如数组。    
#### 单体多字存储器
单体多字存储器就是，存储器中只有一个存储体，每个存储单元存储m个字，总线宽度也为m个字。一次并行读出m个字，地址必须顺序排列并处于同一存储单元。   
在一个存储周期内，从同一地址取出m条指令，然后将指令逐条送至CPU，即每隔1/m个存取周期，CPU向主存读取一条命令，显然提高了单体存储器的工作速度。但是只有当指令和数据是连续存放的，效果才比较明显。  
#### 多体并行存储器
多体并行存储器由多模块组成，每个模块都有相同的容量和存取速度，每个模块都有独立的读写控制电路、地址寄存器、数据寄存器。既能并行工作，也能交叉工作。  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122126242.png)

##### 高位交叉编址（顺序方式）
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122104248.png)
高位交叉编址其实就还是将多个存储器串行存取，实际上还是顺序存储器。每次读取一次后，需要再等待恢复周期，实际并不能提高效率。   
以连续访问00000-00100地址为例：  
设每个存储体存取周期为T，存取时间为r，T=r + 3r   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122109750.png)   
则总耗时为5T  
##### 低位交叉编址（交叉方式）
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122105240.png)     
低位交叉编址是将地址低位设为存储体序号，则CPU读取第一个存储体的内容后，下一个连续地址是下一个存储体的地址，这样可以不用等待前面存储体的恢复周期，从而实现连续读取。 相比高位编址，可以提高效率。    
以连续访问00000-00100地址为例：  
设每个存储体存取周期为T，存取时间为r，T=r + 3r    
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122110146.png)  
则总耗时为T + 4r。 如果连续读取n个存储字，总耗时为T + (n - 1)r，当n足够大时，读取单个存储字的时间约等于r。   
###### 那么应该取几个“体”
低位交叉编址的方式类似于“流水线”的方式进行并行存取，一个存储周期内，m体交叉存储器可以提供的数据量为单个的m倍。  
存取周期为T，存取时间为r，为了使刘淑霞不间断，应该保证模块数m >= T/r。 
存取周期为T，总线传输周期为r，为了使读取不间断，应该保证模块数m >= T/r。  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306122122806.png)
如果m = T / r则刚好完美衔接。  

# 主存储器与CPU的连接

存储芯片的基本结构： 
译码驱动电路、存储矩阵、读写电路、地址线、数据线、控制线、片选线组成   
![](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140029807.png)    

存储芯片需要暴露地址总线和数据总线与CPU进行连接，片选线（一般为CS或CE）供CPU选择，读写控制线（一般为WE或WR，也有可能会拆分为两条线WE和OE）控制对存储芯片的读/写。  

## 单块存储芯片与CPU连接
例如给定一个8 * 8位的存储芯片，直接与CPU连接。  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140041822.png)    
如上图，存储芯片8K\* 1位，即主存存储字长1 bit，主存存储单元2<sup>13</sup>个  
- 13跟地址线A与CPU的16根地址线中的13根地址线接头相连；
- 写使能线WE与CPU的控制线中的写使能线相连
- 1跟数据线D与CPU的8根数据线中的一根相连；
- 片选线CS，由于只有这一个存储芯片与CPU相连接，所以只需要直接给片选线加高电平信号就行
- CPU的最大能力能够处理的是是64K * 64位存储器 ，但是只连接一个存储器，CPU的能力没有被充分利用；不论是机器字长还是地址线。
###### 现代计算机
现在的计算机一般的MDR与MAR都在CPU中。   
![0e9ee0fe3f0a6af182136e640cfd6ad.jpg](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140013309.jpg)    
现在的存储体一般都是由多块存储芯片组成的。   
## 多块存储芯片与CPU连接
单个存储器的数据字长为8位，但是现在CPU可以同时处理的位数为32位，甚至64位，为了最大发挥数据总线的性能，每次多取多读可以减少读写次数，那应该怎么办？即数据总线宽度>存储芯片字长。采用位扩展的方法。     
#### 位扩展（扩展位数）

例如CPU的数据总线是8位，地址总线有16位，现在有若干个地址线有13位，8K\*1位的存储芯片，来进行位扩展，使得CPU的数据总线都用上。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140028744.png)     

地址总线与每个存储芯片进行串行地连接，数据总线与这些存储芯片进行并行连接。   

![d196f66b1b61e06bf8c75562d5f11c3.jpg](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140012159.jpg)    

扩展主存的字数？采用字扩展的方法。   
#### 字扩展（主存容量扩展）

例如CPU的数据总线是8位，地址总线有16位，现在有若干个地址线有13位，8K\*8位的存储芯片，由于数据总线都已经被占满，所以不需要进行位扩展。但是还有3根地址线是空闲的，我们可以将这三根地址线利用上。充分利用CPU的寻址能力。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140028470.png)

**线选法**：这三根地址线可以连接到3块存储芯片的片选线上。三根地址线信号为001则代表选择第一块存储芯片，010代表选择第二块。电路简单，地址空间不连续。   

![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140024796.png)


**片选法**：这三根地址线通过3-8译码器，可以连接到8块存储芯片的片选线上。三根地址线信号为000则代表选择第一块存储芯片，001代表选择第二块。这样就实现了字扩展。  

![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140026840.png)



这样也就是给这8块存储芯片重新编址，类似于高位交叉编址，第一块存储芯片的地址前加上00，范围为000 0000 0000 0000到001 1111 1111 1111，第二块存储芯片的地址范围为010 0000 0000 0000到011 1111 1111 1111以此类推。设计电路较为复杂，但是地址空间连续。

![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140025856.png)

两种方式的比较：   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140050848.png)

字位可以同时扩展！
![adc6e5b6cac19eef4cf3c804aafa9fe.jpg](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140010294.jpg)


## 关于译码器知识补充

译码器也有多个使能信号，CPU可以通过这些使能信号来控制译码器控制片选信号的生效时间。    

译码器 n条线入 ，可以得到2<sup>n</sup>个信号出。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306140051543.png)     
高电平有效，低电平有效译码器，与存储芯片连接时需要注意。    

一般连通后，都需要先等一小会，等待信号稳定后再进行片选，读取数据等操作！     


# 外部存储器

外存又称为辅助存储器，目前主要是使用磁表面存储器（机械硬盘，光盘）  

磁表面存储器是使用最广泛的外存储器。所谓磁表面存储，是用某些磁性材料薄薄地涂在金属铝或塑料表面作载磁体来存储信息。根据记录载体的外形，磁表面存储器有磁鼓、磁带、磁盘、磁卡等。而在计算机系统中广泛使用的是磁盘和磁带；特别是磁盘，几乎是稍具规模系统的基本配置。  
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306141543592.png)

针头上有写线圈与读线圈，划过磁层上方后每次读或写1bit数据，如果要读/写8bit数据，需要转为串行。   

优点：  

1. 存储容量大，位价格低
2. 记录介质可以重复使用
3. 记录信息可以长期保存不丢失，甚至可以脱机读档。
4. 非破坏性读出，读出后不需要重新写入。

缺点：  

1. 存取数据慢
2. 机械机构复杂
3. 对工作环境要求较高（不能处于强磁场区域）

既可以作为输入设备，也可以作为输出设备。  

## 磁盘存储器

### 磁盘设备的组成
1. 存储区域
一块磁盘含有若干个记录面，每个记录面划分为若干条磁道，而每条磁道又划分为若干个扇区，扇区（也叫块）是磁盘读写的最小单位，也就是说磁盘按块读取。   
- 磁头数
记录面数，表示磁盘总共有多少个磁头，磁头用于读取/写入盘片上记录面的信息，一个记录面对应一个磁头。
- 柱面数（从内向外）
表示硬盘每一面上有多少条磁道。在一个盘组中，不同记录面的相同编号（位置）的所有磁道构成一个圆柱面。
- 扇区数（圆周分为几部分扇形）
表示每一条磁道有多少个扇区
2. 硬盘存储器
磁盘驱动器：   
核心部分是磁头组件和盘片组件。一般为机械硬盘的盘面磁头等一系列组件。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306141609365.png)    

磁盘控制器：   
是硬盘存储器与主机的接口。一般是机械硬盘背面的电路板。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306141609402.png)    
### 磁盘的性能指标
###### 磁盘的容量：
一个磁盘所能存储的字节总数。磁盘容量有非格式化容量和格式化容量之分。  
非格式化容量是指磁记录表面可以李彤的磁化单元总数。是理论上硬盘的容量。    
格式化容量是指按照某种特定的记录格式所能存储信息的重量。用户实际能存储数据的容量。   
格式化容量一般比非格式化容量小。      
###### 记录密度：
- 道密度
  沿磁盘半径方向单位长度上的磁道数。例如60道/cm
- 位密度
  磁盘单位长度上能记录的二进制代码位数。例如600bit/cm
- 面密度
  位密度与道密度的乘积，单位面积上能记录的二进制代码
注意：磁盘上所有磁道记录的信息量是相等的，并非越靠外，磁道越长记录的越多。这也表明每条磁道的位密度不同，越靠外位密度越低，越靠内位密度越高。所以磁盘性能很大情况看最内层磁道所存储的信息量。
###### 平均存取时间
平均存取时间 = 寻道时间（磁头移动到要读取的磁道时间） + 旋转延迟时间（磁盘旋转将扇区划到磁头下方） + 传输时间（磁头开始读取数据）。  
###### 数据传输率
单位时间内磁盘存储器向主机传送数据的字节数。假设磁盘转速为r，每条磁道容量为N个字节，则数据传输率为r\*N
### 磁盘地址
主机向磁盘控制器发送寻址信息，
驱动器号（电脑可能有多个硬盘） + 盘面/磁道号（从内到外在哪个圈上） + 盘面号（从上到下在哪个盘上） + 扇区号（确定了哪个盘哪个磁道，再找在哪个扇区）   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306141638329.png)
### 磁盘的工作过程
硬盘的主要操作是寻址，读盘，写盘，每个操作都对应一个控制字，磁盘工作时，第一步是取控制字，第二步是执行控制字。   
磁盘属于机械式部件，其读写操作是串行的，不可能同一时刻读和写，也不可能同时读或写两份数据。   
![image.png](https://cdn.staticaly.com/gh/ivylet/blog_picg-@master/img/202306141641175.png)
### 磁盘阵列（RAID）
RAID （ Redundant Array of Independent Disks ）即独立磁盘冗余阵列，简称为「磁盘阵列」，其实就是用多个独立的磁盘组成在一起形成一个大的磁盘系统，从而实现比单块磁盘更好的存储性能和更高的可靠性。避免数据出现错误导致信息丢失。方案不断更新，安全性越高。      
RAID方案常见的可以分为：
- RAID0：无冗余和无校验（无容错能力）
- RAID1：镜像磁盘阵列（容量减少一半，镜像磁盘互为备份）
- RAID2：采用纠错的海明码的磁盘阵列
- RAID3：位交叉奇偶校验
- RAID4：块交叉奇偶校验
- RAID5：无独立校验的奇偶校验磁盘阵列
## 固态硬盘SSD
##### 原理
基于闪存技术，属于电可擦除ROM，即EEPROM。
##### 组成
- 闪存翻译层
  负责翻译逻辑块号，定位到对应页
- 存储介质，闪存芯片组（包含一个或多个闪存芯片）。
  每个芯片包含多个块，每个块包含多个页。   
##### 读写性能特性
- 以页为单位进行读写，相当于磁盘的扇区。
- 以块为单位擦除，擦干净的块，其中的每一页都可以写一次，读无数次。
- 支持随机访问，系统给定一个逻辑地址，闪存翻译层可以通过电路迅速定位到对应的物理地址。
- 读快、写慢（涉及擦除等操作），要写入的页如果有数据，则不能写入。需要将块内其他页全部复制到一个新的（擦除过的）块中，再写入新的页。
##### 与机械硬盘相比的特点
- SSD读写快，随机访问性能高，用电路控制访问位置。
- SSD安静无噪音，耐摔抗震，能耗低中，造价更贵。
- SSD的一个“块”被擦除次数过多（重复写入同一个块）可能会坏掉，而机械硬盘并不会因为写的次数太多而坏掉。
##### 磨损均衡技术
- 将擦除平均分布在各个块上，以提升使用寿命。
- 动态磨损均衡
  写入数据时，优先选择累计擦除次数少的新闪存块。
- 静态磨损均衡
  SSD监测并自动进行数据分配、迁移、让老旧的块承担以读为主的存储任务，让较新的闪存块承担更多的写任务。

# 高速缓冲器（Cache）
通过提高存储芯片本身的速度与采用并行存储器结构可以缓解CPU与主存之间速度不匹配的问题。除了这两种方法，在CPU与主存之间设置高速缓冲器（Cache），即将频繁访问的数据放入高速存储器，这样CPU读取经常访问的数据的速度就快多了，这样也可以提高CPU访问指令和数据的速度！   
现在Cache一般都被集成到了CPU中，用SRAM实现，速度快，成本高！
## 局部性原理
- 空间局部性：  
在将要使用的信息（指令和数据），很可能与正在使用的信息存在存储空间中相邻的位置，比如使用的数组元素。
- 时间局部性：  
将要使用的信息中，很可能就是现在正在使用的信息。  比如程序中所使用的循环结构。     
基于这个原理不难想到，我们可以把CPU目前访问的地址附近的部分数据存到Cache中。    
访问二维数组内容时，如果先访问列与先访问行内容的空间局部性利用较差！
## Cache的基本工作原理
### 平均访问时间
设t<sub>c</sub>为访问一次Cache所需的时间，t<sub>m</sub>为访问一次主存所需要的时间，命中率H为CPU将要访问的信息在Cache中的比率。   
则 Cache-主存 系统中平均访问时间为：
1. 先访问Cache，找不到再访问主存
t = Ht<sub>c</sub> + (1 - H)(t<sub>m</sub> + T)   
2. 同时访问Cache和主存，若Cache命中则停止访问主存
t = Ht<sub>c</sub> + (1 - H)t<sub>m</sub>
# 虚拟存储器

