  

\begin{enumerate}

    \setcounter{enumi}{1}

    \item  强凸函数的收敛分析 虽然 (1.2)-(1.3) 或 (1.5)-(1.6) 所产生的搜索方向总是下降方向，但我们需要限制 $\alpha_{k}$ 的选择以确保收敛性。我们考虑满足 Goldstein 条件 [14] 的直线搜索、

\end{enumerate}

  
  

\begin{equation*}

    \delta_{1} \alpha_{k} \mathbf{g}_{k}^{T} \mathbf{d}_{k} \leq f\left(\mathbf{x}_{k}+\alpha_{k} \mathbf{d}_{k}\right)-f\left(\mathbf{x}_{k}\right) \leq \delta_{2} \alpha_{k} \mathbf{g}_{k}^{T} \mathbf{d}_{k}, \tag{2.1}

\end{equation*}

  
  
  

其中，$0 < \delta_{2}<\frac{1}{2}<\delta_{1}<1$ 和 $\alpha_{k}>0$ 或沃尔夫条件 [40, 41]、

  
  
  
  

\begin{align*}

    f\left(\mathbf{x}_{k}+\alpha_{k} \mathbf{d}_{k}\right)-f\left(\mathbf{x}_{k}\right) & \leq \delta \alpha_{k} \mathbf{g}_{k}^{T} \mathbf{d}_{k},  \tag{2.2} \\

    \mathbf{g}_{k+1}^{T} \mathbf{d}_{k}                                                 & \geq \sigma \mathbf{g}_{k}^{T} \mathbf{d}_{k}, \tag{2.3}

\end{align*}

  
  

满足 $0<\delta \leq \sigma<1$.

与 [8] 中一样，我们不需要 "强沃尔夫 "条件 $\left|\mathbf{g}_{k+1}^{T}\right| \leq-\sigma \mathbf{g}_{k}^{T} \mathbf{d}_{k}$ 通常用来证明非线性共轭梯度方法的收敛性。

  
  
  
  

定理 2.1. 假设 $\mathbf{d}_{k}$ 是一个下降方向，并且 $\nabla f$ 满足 Lipschitz 条件

  
  
  

$$

    \left\|\nabla f(\mathbf{x})-\nabla f\left(\mathbf{x}_{k}\right)\right\| \leq L\left\|\mathbf{x}-\mathbf{x}_{k}\right\|

$$

  
  

连接 $\mathbf{x}_{k}$ 和 $\mathbf{x}_{k+1}$ 的线段上的所有 $\mathbf{x}$ ，其中 $L$ 是常数。如果线段搜索满足戈尔茨坦条件，那么

  
  
  

\begin{equation*}

    \alpha_{k} \geq \frac{\left(1-\delta_{1}\right)}{L} \frac{\left|\mathbf{g}_{k}^{T} \mathbf{d}_{k}\right|}{\left\|\mathbf{d}_{k}\right\|^{2}} \tag{2.4}

\end{equation*}

  
  
  

如果直线搜索满足沃尔夫条件，那么

  
  

\begin{equation*}

    \alpha_{k} \geq \frac{1-\sigma}{L} \frac{\left|\mathbf{g}_{k}^{T} \mathbf{d}_{k}\right|}{\left\|\mathbf{d}_{k}\right\|^{2}} \tag{2.5}

\end{equation*}

  
  
  

证明 为了方便读者，我们附上这些著名结果的证明。如果Goldstein条件成立，那么根据（2.1）和均值定理，\\

我们有

  
  

$$

    \begin{aligned}

        \delta_{1} \alpha_{k} \mathbf{g}_{k}^{T} \mathbf{d}_{k} & \leq f\left(\mathbf{x}_{k}+\alpha_{k} \mathbf{d}_{k}\right)-f\left(\mathbf{x}_{k}\right)            \\

                                                                & =\alpha_{k} \nabla f\left(\mathbf{x}_{k}+\xi \mathbf{d}_{k}\right) \mathbf{d}_{k}                   \\

                                                                & \leq \alpha_{k} \mathbf{g}_{k}^{T} \mathbf{d}_{k}+L \alpha_{k}^{2}\left\|\mathbf{d}_{k}\right\|^{2}

    \end{aligned}

$$

  
  

其中 $\xi \in\left[0, \alpha_{k}\right]$。对这个不等式进行重排，得到 (2.4)。

减去 $\mathbf{g}_{k}^{T}$ 利用 Lipschitz 条件从 (2.3) 两边减去 $\mathbf{d}_{k}$ 得到

$$

    (\sigma-1) \mathbf{g}_{k}^{T} \mathbf{d}_{k} \leq\left(\mathbf{g}_{k+1}-\mathbf{g}_{k}\right)^{T} \mathbf{d}_{k} \leq \alpha_{k} L\left\|\mathbf{d}_{k}\right\|^{2}

$$

  
  

由于 $mathbf{d}_{k}$ 是一个下降方向，并且 $\sigma<1, (2.5)$ 立即得出。$quad \square$

现在我们证明当 $f$ 是强凸时，无限制方案 (1.2)-(1.3) 的收敛性。

定理 2.2. 假设 $f$ 是强凸的且在水平集上是 Lipschitz 连续的

  
  

\begin{equation*}

    \mathcal{L}=\left\{\mathbf{x} \in \mathbb{R}^{n}: f(\mathbf{x}) \leq f\left(\mathbf{x}_{0}\right)\right\} \tag{2.6}

\end{equation*}

  
  
  

也就是说，存在常量 $L$ 和 $\mu>0$ ，使得

  
  
  
  

\begin{align*}

    \|\nabla f(\mathbf{x})-\nabla f(\mathbf{y})\| & \leq L\|\mathbf{x}-\mathbf{y}\| \text { and }  \tag{2.7}               \\

    \mu\|\mathbf{x}-\mathbf{y}\|^{2}              & \leq(\nabla f(\mathbf{x})-\nabla f(\mathbf{y}))(\mathbf{x}-\mathbf{y})

\end{align*}

  
  
  

对于所有 $\mathbf{x}$ 和 $\mathbf{y}$ .在 $\mathcal{L}$ 中。如果共轭梯度法（1.2）-（1.3）的每一步都使用满足沃尔夫条件或戈尔茨坦条件的直线搜索，那么对于某个 $k$，要么 $\mathbf{g}_{k}=\mathbf{0}$ ，要么 $\mathbf{y}=\mathcal{L}$ 。

  
  
  

\begin{equation*}

    \lim _{k \rightarrow \infty} \mathbf{g}_{k}=\mathbf{0} \tag{2.8}

\end{equation*}

  
  
  

证明 假设 $\mathbf{g}_{k} \neq \mathbf{0}$ 对于所有 $k$。根据强凸假设

  
  
  

\begin{equation*}

    \mathbf{y}_{k}^{T} \mathbf{d}_{k}=\left(\mathbf{g}_{k+1}-\mathbf{g}_{k}\right)^{T} \mathbf{d}_{k} \geq \mu \alpha_{k}\left\|\mathbf{d}_{k}\right\|^{2} \tag{2.9}

\end{equation*}

  
  
  

定理 1.1 和假设 $\mathbf{g}_{k} \neq \mathbf{0} $ 表明$\mathbf{d}_{k}\neq \mathbf{0}$。因为 $\alpha_{k}>0$, 所以从 (2.9) 可以得出 $\mathbf{y}_{k}^{T}. \mathbf{d}_{k}>0$. 由于 $f$ 在 $\mathcal{L}$ 上是强凸的，所以 $f$ 从下往上是有界的。对 $k$ 求和 (2.1) 或 (2.2) 中的上界后，我们得出结论

  
  
  
  

$$

    \sum_{k=0}^{\infty} \alpha_{k} \mathbf{g}_{k}^{T} \mathbf{d}_{k}>-\infty

$$

  
  

将其与 Lemma 2.1 中给出的 $\alpha_{k}$ 下限以及下降特性 (1.9) 结合起来，可以得出

  
  
  
  
  

\begin{equation*}

    \sum_{k=0}^{\infty} \frac{\left\|\mathbf{g}_{k}\right\|^{4}}{\left\|\mathbf{d}_{k}\right\|^{2}}<\infty \tag{2.10}

\end{equation*}

  
  
  

根据 Lipschitz 连续性 (2.7)、

  
  
  
  
  

\begin{equation*}

    \left\|\mathbf{y}_{k}\right\|=\left\|\mathbf{g}_{k+1}-\mathbf{g}_{k}\right\|=\left\|\nabla f\left(\mathbf{x}_{k}+\alpha_{k} \mathbf{d}_{k}\right)-\nabla f\left(\mathbf{x}_{k}\right)\right\| \leq L \alpha_{k}\left\|\mathbf{d}_{k}\right\| \tag{2.11}

\end{equation*}

  
  
  

利用 (2.9) 和 (1.3)，我们得出

  
  
  
  
  

\begin{align*}

    \left|\beta_{k}^{N}\right| & =\left|\frac{\mathbf{y}_{k}^{T} \mathbf{g}_{k+1}}{\mathbf{d}_{k}^{T} \mathbf{y}_{k}}-2 \frac{\left\|\mathbf{y}_{k}\right\|^{2} \mathbf{d}_{k}^{T} \mathbf{g}_{k+1}}{\left(\mathbf{d}_{k}^{T} \mathbf{y}_{k}\right)^{2}}\right|                                                               \\

                               & \leq \frac{\left\|\mathbf{y}_{k}\right\|\left\|\mathbf{g}_{k+1}\right\|}{\mu \alpha_{k}\left\|\mathbf{d}_{k}\right\|^{2}}+2 \frac{\left\|\mathbf{y}_{k}\right\|^{2}\left\|\mathbf{d}_{k}\right\|\left\|\mathbf{g}_{k+1}\right\|}{\mu^{2} \alpha_{k}^{2}\left\|\mathbf{d}_{k}\right\|^{4}}    \\

                               & \leq \frac{L \alpha_{k}\left\|\mathbf{d}_{k}\right\|\left\|\mathbf{g}_{k+1}\right\|}{\mu \alpha_{k}\left\|\mathbf{d}_{k}\right\|^{2}}+2 \frac{L^{2} \alpha_{k}^{2}\left\|\mathbf{d}_{k}\right\|^{3}\left\|\mathbf{g}_{k+1}\right\|}{\mu^{2} \alpha_{k}^{2}\left\|\mathbf{d}_{k}\right\|^{4}} \\

                               & \leq\left(\frac{L}{\mu}+\frac{2 L^{2}}{\mu^{2}}\right) \frac{\left\|\mathbf{g}_{k+1}\right\|}{\left\|\mathbf{d}_{k}\right\|} \tag{2.12}

\end{align*}

  

因此，我们得出

  

$$

    \left\|\mathbf{d}_{k+1}\right\| \leq\left\|\mathbf{g}_{k+1}\right\|+\left|\beta_{k}^{N}\right|\left\|\mathbf{d}_{k}\right\| \leq\left(1+\frac{L}{\mu}+\frac{2 L^{2}}{\mu^{2}}\right)\left\|\mathbf{g}_{k+1}\right\|

$$

  
  

在 (2.10) 中插入 $\mathbf{d}_{k}$ 的上界，得到

  

$$

    \sum_{k=1}^{\infty}\left\|\mathbf{g}_{k}\right\|^{2}<\infty

$$

  
  

这就完成了证明。

现在我们观察一下，当 $f$ 是强凸且 $\mathbf{d}_{k}$ 与 $\mathbf{g}_{k+1}$ 之间的夹角余弦足够小时，新的共轭梯度更新 (1.2) 所产生的方向近似指向佩里-山诺方向 (1.4)。根据 (2.9) 和 (2.11)，我们有

  

\begin{equation*}

    \frac{\left|\mathbf{d}_{k}^{T} \mathbf{g}_{k+1}\right|}{\left|\mathbf{d}_{k}^{T} \mathbf{y}_{k}\right|}\left\|\mathbf{y}_{k}\right\| \leq \frac{L}{\mu}\left|\mathbf{u}_{k}^{T} \mathbf{g}_{k+1}\right|=c_{1} \epsilon\left\|\mathbf{g}_{k+1}\right\| \tag{2.13}

\end{equation*}

  
  
  

当 $\mathbf{u}_{k}=\mathbf{d}_{k} \left|\mathbf{d}_{k}\right|$ 是 $\mathbf{d}_{k}$ 方向上的单位向量，$\epsilon$ 是 $\mathbf{d}_{k}$ 与 $\mathbf{g}_{k+1}$ 之间夹角的余弦，$c_{1}=L / \mu$。根据（1.2）中 $\mathbf{d}_{k+1}$ 的定义，我们有

  
  
  
  
  

\begin{equation*}

    \left\|\mathbf{d}_{k+1}\right\|^{2} \geq\left\|\mathbf{g}_{k+1}\right\|^{2}-2 \beta_{k}^{N} \mathbf{d}_{k}^{T} \mathbf{g}_{k+1} \tag{2.14}

\end{equation*}

  
  
  

根据 (2.12) 中的 $\beta_{k}^{N}$ 约束、

  
  
  
  
  

\begin{equation*}

    \left|\beta_{k}^{N} \mathbf{d}_{k}^{T} \mathbf{g}_{k+1}\right| \leq c_{2}\left|\mathbf{u}_{k}^{T} \mathbf{g}_{k+1}\right|\left\|\mathbf{g}_{k+1}\right\|=c_{2} \epsilon\left\|\mathbf{g}_{k+1}\right\|^{2} \tag{2.15}

\end{equation*}

  

其中 $c_{2}$ 是出现在 (2.12) 中的常数。结合 (2.14) 和 (2.15)，我们得出

  

$$

    \left\|\mathbf{d}_{k+1}\right\| \geq \sqrt{1-2 c_{2} \epsilon}\left\|\mathbf{g}_{k+1}\right\|

$$

  
  

$\left\|\mathbf{d}_{k+1}\right\|$ 的下界和 (1.4) 中 $\mathbf{y}_{k}$ 项的上界 (2.13) 意味着它们之间的比值受 $c_{1} 约束。\epsilon / \sqrt{1-2 c_{2} \epsilon}$。因此，当 $\epsilon$ 较小时，(1.2) 所产生的方向近似于 PerryShanno 方向 (1.4) 的倍数。

  
  

\begin{enumerate}

    \setcounter{enumi}{2}

    \item

          一般非线性函数的收敛分析。我们对一般非线性函数 (1.5)-(1.6) 的分析利用了 Gilbert 和 Nocedal 在分析 PRP+ 方案时提出的见解[13]。与 [13] 中的方法类似，我们为归一化方向上的变化 $\mathbf{u}_{k+1}-\mathbf{u}_{k}$ 建立了一个约束。$\left|\mathbf{d}_{k}\right|$，我们用它得出一个矛盾的结论：梯度不可能远离零。下面的定理与 [13, Lem. 4.1] 类似；不同之处在于对方向更新公式 (1.5) 的处理。

\end{enumerate}

  
  

难题 3.1. 如果水平集 (2.6) 是有界的，且 Lipschitz 条件 (2.7) 成立，那么对于方案 (1.5)-(1.6) 和满足 Wolfe 条件 (2.2)-(2.3) 的直线搜索，我们有

  
  
  
  

$$

    \mathbf{d}_{k} \neq \mathbf{0} \quad \text { for each } k \text { and } \sum_{k=0}^{\infty}\left\|\mathbf{u}_{k+1}-\mathbf{u}_{k}\right\|^{2}<\infty

$$

  
  

只要 $inf \left\{\left\|\mathbf{g}_{k}\right\|: k \geq 0\right\}>0$.

证明。定义 $\gamma=\inf {\left\|\mathbf{g}_{k}\right\|: k \geq 0}$. 由于假定 $\gamma>0$, 所以根据定理 1.1 的下降性质，可以得出对于每个$k$,有$\mathbf{d}_{k}\neq \mathbf{0}$。由于 $mathcal{L}$ 是有界的，所以 $f$ 从下往上也是有界的，根据 (2.2) 和 (2.5)，下面的 Zoutendijk 条件 [42] 成立：

  

$$

    \sum_{k=0}^{\infty} \frac{\left(\mathbf{g}_{k}^{T} \mathbf{d}_{k}\right)^{2}}{\left\|\mathbf{d}_{k}\right\|^{2}}<\infty

$$

  
  

同样，根据下降特性可以得出

  

\begin{equation*}

    \gamma^{4} \sum_{k=0}^{\infty} \frac{1}{\left\|\mathbf{d}_{k}\right\|^{2}} \leq \sum_{k=0}^{\infty} \frac{\left\|\mathbf{g}_{k}\right\|^{4}}{\left\|\mathbf{d}_{k}\right\|^{2}} \leq \frac{64}{49} \sum_{k=0}^{\infty} \frac{\left(\mathbf{g}_{k}^{T} \mathbf{d}_{k}\right)^{2}}{\left\|\mathbf{d}_{k}\right\|^{2}}<\infty \tag{3.1}

\end{equation*}

  
  

定义量

  

$$

    \beta_{k}^{+}=\max \left\{\bar{\beta}_{k}^{N}, 0\right\}, \quad \beta_{k}^{-}=\min \left\{\bar{\beta}_{k}^{N}, 0\right\}, \quad \mathbf{r}_{k}=\frac{-\mathbf{g}_{k}+\beta_{k-1}^{-} \mathbf{d}_{k-1}}{\left\|\mathbf{d}_{k}\right\|}, \quad \delta_{k}=\beta_{k-1}^{+} \frac{\left\|\mathbf{d}_{k-1}\right\|}{\left\|\mathbf{d}_{k}\right\|} .

$$

  

根据 (1.5)-(1.6) 可以得出

  

$$

    \mathbf{u}_{k}=\frac{\mathbf{d}_{k}}{\left\|\mathbf{d}_{k}\right\|}=\frac{-\mathbf{g}_{k}+\left(\beta_{k-1}^{+}+\beta_{k-1}^{-}\right) \mathbf{d}_{k-1}}{\left\|\mathbf{d}_{k}\right\|}=\mathbf{r}_{k}+\delta_{k} \mathbf{u}_{k-1}

$$

  

因为 $\mathbf{u}_{k}$ 是单位向量、

  

$$

    \left\|\mathbf{r}_{k}\right\|=\left\|\mathbf{u}_{k}-\delta_{k} \mathbf{u}_{k-1}\right\|=\left\|\delta_{k} \mathbf{u}_{k}-\mathbf{u}_{k-1}\right\|

$$

  

由于 $\delta_{k}>0$，因此可以得出

  
  

\begin{align*}

    \left\|\mathbf{u}_{k}-\mathbf{u}_{k-1}\right\| & \leq\left\|\left(1+\delta_{k}\right)\left(\mathbf{u}_{k}-\mathbf{u}_{k-1}\right)\right\|                                \\

                                                   & \leq\left\|\mathbf{u}_{k}-\delta_{k} \mathbf{u}_{k-1}\right\|+\left\|\delta_{k} \mathbf{u}_{k}-\mathbf{u}_{k-1}\right\| \\

                                                   & =2\left\|\mathbf{r}_{k}\right\| \tag{3.2}

\end{align*}

  
  

根据 $\beta_{k}^{-}$ 的定义以及 $\eta_{k}<0$ 和 $\bar{beta}_{k}^{N}$ 的事实 $\geq \eta_{k}$ 在 (1.6) 中，我们可以得到 $\mathbf{r}_{k}$ 分子的如下约束：

  

$$

    \begin{aligned}

        \left\|-\mathbf{g}_{k}+\beta_{k-1}^{-} \mathbf{d}_{k-1}\right\| & \leq\left\|\mathbf{g}_{k}\right\|-\min \left\{\bar{\beta}_{k-1}^{N}, 0\right\}\left\|\mathbf{d}_{k-1}\right\|                    \\

                                                                        & \leq\left\|\mathbf{g}_{k}\right\|-\eta_{k-1}\left\|\mathbf{d}_{k-1}\right\|                                                      \\

                                                                        & \leq\left\|\mathbf{g}_{k}\right\|+\frac{1}{\left\|\mathbf{d}_{k-1}\right\| \min \{\eta, \gamma\}}\left\|\mathbf{d}_{k-1}\right\| \\

                                                                        & \leq \Gamma+\frac{1}{\min \{\eta, \gamma\}}

    \end{aligned}

$$

  

where

  
  

\begin{equation*}

    \Gamma=\max _{\mathbf{x} \in \mathcal{L}}\|\nabla f(\mathbf{x})\| \tag{3.4}

\end{equation*}

  
  
  

让 $c$ 表示 (3.3) 中的表达式 $\Gamma$ + 1 / min $\mathbf{\eta,\gamma}$。$\mathbf{r}_{k}$分子的这一约束与（3.2）结合得出

  
  
  
  
  

\begin{equation*}

    \left\|\mathbf{u}_{k}-\mathbf{u}_{k-1}\right\| \leq 2\left\|\mathbf{r}_{k}\right\| \leq \frac{2 c}{\left\|\mathbf{d}_{k}\right\|} \tag{3.5}

\end{equation*}

  
  
  

最后，通过平方 (3.5)，对 $k$ 求和，并利用 (3.1)，我们完成了证明。

定理 3.2. 如果水平集 (2.6) 是有界的，且 Lipschitz 条件 (2.7) 成立，那么对于方案 (1.5)-(1.6) 以及满足沃尔夫条件 (2.2)-(2.3) 的直线搜索，对于某个 $k$，要么 $\mathbf{g}_{k}=\mathbf{0}$ ，要么

  
  

\begin{equation*}

    \liminf _{k \rightarrow \infty}\left\|\mathbf{g}_{k}\right\|=0 \tag{3.6}

\end{equation*}

  
  
  

证明 我们假设对于所有 $k$ 都是 $\mathbf{g}_{k} \neq \mathbf{0}$ 对于所有 $k$ 并且 $\lim \inf _{k \rightarrow \infty}\left\|\mathbf{g}_{k}\right\|>0$. 下面，我们会得到一个矛盾。定义$\gamma=inf\{\left\|\mathbf{g}_{k}\right\|: {k} \geq 0\}$, 由于（3.6）和$\mathbf{g}_{k} \neq {0}$的事实，我们有$\gamma>0$。 对于所有 $k$。证明分为以下三个步骤

I. $A$ bound for $\bar{beta}_{k}^{N}$. 根据沃尔夫条件 $\mathbf{g}_{k+1}^{T} \mathbf{d}_{k} \geq \sigma \mathbf{g}_{k}^{T} \ $我们有

  
  
  

\begin{equation*}

    \mathbf{y}_{k}^{T} \mathbf{d}_{k}=\left(\mathbf{g}_{k+1}-\mathbf{g}_{k}\right)^{T} \mathbf{d}_{k} \geq(\sigma-1) \mathbf{g}_{k}^{T} \mathbf{d}_{k}=-(1-\sigma) \mathbf{g}_{k}^{T} \mathbf{d}_{k} . \tag{3.7}

\end{equation*}

  
  

根据定理 1.1、

  
  

$$

    -\mathbf{g}_{k}^{T} \mathbf{d}_{k} \geq \frac{7}{8}\left\|\mathbf{g}_{k}\right\|^{2} \geq \frac{7}{8} \gamma^{2} .

$$

  

将其与 (3.7) 结合，得出

  
  

\begin{equation*}

    \mathbf{y}_{k}^{T} \mathbf{d}_{k} \geq(1-\sigma) \frac{7}{8} \gamma^{2} \tag{3.8}

\end{equation*}

  
  

另外，请注意

  
  

\begin{equation*}

    \mathbf{g}_{k+1}^{T} \mathbf{d}_{k}=\mathbf{y}_{k}^{T} \mathbf{d}_{k}+\mathbf{g}_{k}^{T} \mathbf{d}_{k}<\mathbf{y}_{k}^{T} \mathbf{d}_{k} . \tag{3.9}

\end{equation*}

  
  

沃尔夫条件再次给出

  
  

\begin{equation*}

    \mathbf{g}_{k+1}^{T} \mathbf{d}_{k} \geq \sigma \mathbf{g}_{k}^{T} \mathbf{d}_{k}=-\sigma \mathbf{y}_{k}^{T} \mathbf{d}_{k}+\sigma \mathbf{g}_{k+1}^{T} \mathbf{d}_{k} . \tag{3.10}

\end{equation*}

  
  

由于 $sigma<1$ ，我们可以对 (3.10) 进行重排，得到

  
  

$$

    \mathbf{g}_{k+1}^{T} \mathbf{d}_{k} \geq \frac{-\sigma}{1-\sigma} \mathbf{y}_{k}^{T} \mathbf{d}_{k}

$$

  
  

将 $\mathbf{g}_{k+1}^{T}$ 的下界与上界（3.9）结合起来，就得到了 $\mathbf{d}_{k}$ 的上界。$\mathbf{d}_{k}$ 与上界 (3.9) 相结合得到

  
  

\begin{equation*}

    \left|\frac{\mathbf{g}_{k+1}^{T} \mathbf{d}_{k}}{\mathbf{y}_{k}^{T} \mathbf{d}_{k}}\right| \leq \max \left\{\frac{\sigma}{1-\sigma}, 1\right\} \tag{3.11}

\end{equation*}

  
  
  

根据（1.6）中 $\bar{\beta}_{k}^{N}$ 的定义，我们可以得出

  
  
  
  

$$

    \bar{\beta}_{k}^{N}=\beta_{k}^{N} \text { if } \beta_{k}^{N} \geq 0 \quad \text { and } \quad 0 \geq \bar{\beta}_{k}^{N} \geq \beta_{k}^{N} \text { if } \beta_{k}^{N}<0 \text {. }

$$

  
  

因此，对于每个 $k$ 来说,有$\left|\bar{\beta}_{k}^{N}\right|\leq\left|\beta_{k}^{N}\right|$。我们现在插入 $\left|\mathbf{g}_{k+1}^{T} \mathbf{d}_{k}\right| /\left|\mathbf{y}_{k}^{T} \mathbf{d}_{k}\right| $ 为(3.11)的上界, 插入$\mathbf{y}_{k}^{T} \mathbf{d}_{k}$为(3.8)的下界 ， 和 $\mathbf{d}_{k}$ 的 Lipschitz 估计 (2.11) 放入表达式 (1.3) 得到

  
  
  
  
  

\begin{align*}

    \left|\bar{\beta}_{k}^{N}\right| & \leq\left|\beta_{k}^{N}\right|                                                                                                                                                                                                                                        \\

                                     & \leq \frac{1}{\left|\mathbf{d}_{k}^{T} \mathbf{y}_{k}\right|}\left(\left|\mathbf{y}_{k}^{T} \mathbf{g}_{k+1}\right|+2\left\|\mathbf{y}_{k}\right\|^{2} \frac{\left|\mathbf{g}_{k+1}^{T} \mathbf{d}_{k}\right|}{\left|\mathbf{y}_{k}^{T} \mathbf{d}_{k}\right|}\right) \\

                                     & \leq \frac{8}{7} \frac{1}{(1-\sigma) \gamma^{2}}\left(L \Gamma\left\|\mathbf{s}_{k}\right\|+2 L^{2}\left\|\mathbf{s}_{k}\right\|^{2} \max \left\{\frac{\sigma}{1-\sigma}, 1\right\}\right)                                                                            \\

                                     & \leq C\left\|\mathbf{s}_{k}\right\|, \tag{3.12}

\end{align*}

  
  
  

其中 $\Gamma$ 的定义见 (3.4)，$C$ 的定义如下：

  
  

\begin{align*}

     & C=\frac{8}{7} \frac{1}{(1-\sigma) \gamma^{2}}\left(L \Gamma+2 L^{2} D \max \left\{\frac{\sigma}{1-\sigma}, 1\right\}\right)  \tag{3.13} \\

     & D=\max \{\|\mathbf{y}-\mathbf{z}\|: \mathbf{y}, \mathbf{z} \in \mathcal{L}\} . \tag{3.14}

\end{align*}

  
  

这里的 $D$ 是 $\mathcal{L}$ 的直径。

II. 步长 $\mathbf{s}_{k}$ 的约束. 这是 [13, Thm. 4.3] 的修正版。请注意，对于任意 $l \geq k$、

  

$$

    \mathbf{x}_{l}-\mathbf{x}_{k}=\sum_{j=k}^{l-1} \mathbf{x}_{j+1}-\mathbf{x}_{j}=\sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\| \mathbf{u}_{j}=\sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\| \mathbf{u}_{k}+\sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\|\left(\mathbf{u}_{j}-\mathbf{u}_{k}\right)

$$

  
  

根据三角形不等式

  

\begin{equation*}

    \sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\| \leq\left\|\mathbf{x}_{l}-\mathbf{x}_{k}\right\|+\sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\|\left\|\mathbf{u}_{j}-\mathbf{u}_{k}\right\| \leq D+\sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\|\left\|\mathbf{u}_{j}-\mathbf{u}_{k}\right\| . \tag{3.15}

\end{equation*}

  

让 $\Delta$ 是一个正整数，选得足够大，以便

  
  

\begin{equation*}

    \Delta \geq 4 C D \tag{3.16}

\end{equation*}

  

其中 $C$ 和 $D$ 出现在 (3.13) 和 (3.14) 中。选择足够大的 $k_{0}$，以便

  
  
  

\begin{equation*}

    \sum_{i \geq k_{0}}\left\|\mathbf{u}_{i+1}-\mathbf{u}_{i}\right\|^{2} \leq \frac{1}{4 \Delta} \tag{3.17}

\end{equation*}

  
  
  

根据 Lemma 3.1，$k_{0}$ 可以这样选择。如果 $j>k \geq k_{0}$ 和 $j-k \leq \Delta$，那么根据 (3.17) 和 Cauchy-Schwarz 不等式，我们有

  
  

$$

    \begin{aligned}

        \left\|\mathbf{u}_{j}-\mathbf{u}_{k}\right\| & \leq \sum_{i=k}^{j-1}\left\|\mathbf{u}_{i+1}-\mathbf{u}_{i}\right\|                                    \\

                                                     & \leq \sqrt{j-k}\left(\sum_{i=k}^{j-1}\left\|\mathbf{u}_{i+1}-\mathbf{u}_{i}\right\|^{2}\right)^{1 / 2} \\

                                                     & \leq \sqrt{\Delta}\left(\frac{1}{4 \Delta}\right)^{1 / 2}=\frac{1}{2}

    \end{aligned}

$$

  
  

与 (3.15) 结合可得

  
  

\begin{equation*}

    \sum_{j=k}^{l-1}\left\|\mathbf{s}_{j}\right\| \leq 2 D \tag{3.18}

\end{equation*}

  
  
  

当 $l>k \geq k_{0}$ 和 $l-k \leq \Delta$ 时。

III. 关于方向 $\mathbf{d}_{l}$ 的 $A$ 约束. 根据（1.5）和步骤 I 中给出的 $\bar{\beta}_{k}^{N}$ 的约束，我们有

$$

    \left\|\mathbf{d}_{l}\right\|^{2} \leq\left(\left\|\mathbf{g}_{l}\right\|+\left|\bar{\beta}_{l-1}^{N}\right|\left\|\mathbf{d}_{l-1}\right\|\right)^{2} \leq 2 \Gamma^{2}+2 C^{2}\left\|\mathbf{s}_{l-1}\right\|^{2}\left\|\mathbf{d}_{l-1}\right\|^{2},

$$

  
  

其中，$\Gamma$ 是 (3.4) 中给出的梯度约束。定义 $S_{i}=2 C^{2}\left\|\mathbf{s}_{i}\right\|^{2}$，我们可以得出结论：对于 $l>k_{0}$、

  

\begin{equation*}

    \left\|\mathbf{d}_{l}\right\|^{2} \leq 2 \Gamma^{2}\left(\sum_{i=k_{0}+1}^{l} \prod_{j=i}^{l-1} S_{j}\right)+\left\|\mathbf{d}_{k_{0}}\right\|^{2} \prod_{j=k_{0}}^{l-1} S_{j} \tag{3.19}

\end{equation*}

  
  
  

在上面的定义中，只要索引范围是空的，乘积就是 1。下面让我们考虑 $\Delta$ 连续 $S_{j}$ 的乘积，其中 $k \geq k_{0}$ ：

  
  

$$

    \begin{aligned}

        \prod_{j=k}^{k+\Delta-1} S_{j} & =\prod_{j=k}^{k+\Delta-1} 2 C^{2}\left\|\mathbf{s}_{j}\right\|^{2}=\left(\prod_{j=k}^{k+\Delta-1} \sqrt{2} C\left\|\mathbf{s}_{j}\right\|\right)^{2}                                           \\

                                       & \leq\left(\frac{\sum_{j=k}^{k+\Delta-1} \sqrt{2} C\left\|\mathbf{s}_{j}\right\|}{\Delta}\right)^{2 \Delta} \leq\left(\frac{2 \sqrt{2} C D}{\Delta}\right)^{2 \Delta} \leq \frac{1}{2^{\Delta}}

    \end{aligned}

$$

  
  

上述第一个不等式是算术几何平均不等式，第二个不等式是由于 (3.18)，第三个不等式来自 (3.16)。由于 $\Delta$ 连续 $S_{j}$ 的乘积有界于 $1 / 2^{\Delta}$，因此可以得出 (3.19) 中的和是有界的，并且这个界值与 $l$ 无关。这个与 $l>k_{0}$ 无关的 $\left\|\mathbf{d}_{l}\right\|$ 约束与 (3.1) 相矛盾。因此，$\gamma=\liminf _{k \rightarrow \infty}\left\|\mathbf{g}_{k}\right\|=0$.